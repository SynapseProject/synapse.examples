Name: TestRCA
Description: Test RemoteCommand Handler
IsActive: true
Actions:
- Name: Hostname
  Handler:
    Type: Synapse.Handlers.CommandLine:CommandLineHandler
    Config:
      Type: Yaml
      Values:
        WorkingDirectory: C:\Temp
        Command: powershell.exe
        TimeoutMills: 10000
        TimeoutAction: Error
  Parameters:
    Type: Yaml
    Values:
      Parser: Regex
      Arguments: 
        ArgString: -ExecutionPolicy Bypass Invoke-Command -ScriptBlock { ~~SCRIPT~~ }
        Expressions:
        - Find: ~~SCRIPT~~
          ReplaceWith: |
            param(
              [string]$p1 = 'aaa',
              [string]$p2 = 'bbb',
              [string]$p3 = 'ccc'
            )
            write-host "P1 = $p1"
            write-host "P2 = $p2"
            write-host "P3 = $p3"
            hostname
            whoami
            write-host "Hello World"
            exit -1
        - Find: aaa
          ReplaceWith: xxx 
